# Josh Stanley

# Submission for Florida State Science Fair




Creating a cost effective, real time, deep learning application for the early detection of plant disease


![newgraph](https://github.com/user-attachments/assets/1b461838-2401-42f8-9410-81332543404e)






iOS version: V0.1 alpha


This repository is organized into 6 sections:



Section 1 - Overview of repository
Section 2 - Project organization and directories
Section 3 - Application structure and deep learning backend
Section 4 - Package requirements and installations
Section 5 - Raspberry Pi 5
Section 6 - Version history











# Section 1 - Overview of repository

This repository contains all code used in the development of my project. It has been organized in folders for their different use cases. The final python application is listed in its own directory as Science Research Final Application.py. The application will not function properly without the necessary packages installed, highlighted in Section 4. 

<img width="1190" alt="Screenshot 2025-01-12 at 7 45 44 PM" src="https://github.com/user-attachments/assets/8759f21e-4eac-4fc4-99d3-bcfbdf0b85fb" />

# Section 2 - Project organization and directories

All code has been organized into folders based on the role they played in the development of my application, listed here:


Previous versions: 
	Previous versions of application are listed here.

Model training: 
	This contains all the code to train every model I developed, ranging from both the CNN and R-CNN

Model evaluation: 
	This contains the code I used to measure the model accuracy of both my models. It also includes a program to run my leaf detection model specifically on video test footage. 
Graphs: 
	This folder has every graph generated by my code when developing my application.



Raspberry Pi 5 and LiteRT: 
	This contains all the code necessary for model conversion to LiteRT, the .HAR Hailo format, the .HEF Hailo format, and the Hailo model optimizer. 

Early project development: 
	This contains code I used either for learning how to interact with different Python packages or learning how to program deep learning models. Some code in this folder was used to train smaller, learning stage models that were not implemented or used in the development of the actual application.

Models: 
	This folder contains every model used in the development of my application as well as the final. Models located in the “final” folder were used in the final application. Models located in the “previous” folder were used in older application versions. Models located in the “Hailo” folder were used on the Hailo 8L chip, and cannot be interacted with unless on that specific hardware.


# Section 3 - Application structure and deep learning backend

The plant disease application functions by using two different machine learning models, a Convolutional Neural Network (CNN), and a Regional Convolutional Neural Network, or object detection model. 

Regional Convolutional Neural Network - 

This model is the first phase in the machine learning backend, it’s goal to automate the crop analysis system. It works by detecting isolating multiple leaf images it finds in either live camera footage or prerecorded video footage, and then individually cropping all the leaves detected in each frame of the video.







Convolutional Neural Network -

This model is the second phase in the machine learning backend, it’s goal to classify the cropped leaf images from the R-CNN, and analyzing the leaves to detect disease in a crop. 

# Section 4 - Package requirements and installations

This project involved the use of many different Python libraries. All code will not function properly if the necessary libraries are not installed, which are detailed here. You can install all of these packages via pip, by running this command in your terminal:

	pip install <python library>

While the majority of these packages will install automatically from the internet, any Hailo libraries require the wheel to be downloaded from their website. These libraries also require to be installed on an x86 Ubuntu system only, with the exception of HailoRT being compatible with a wider range of operating systems and hardware. 
These Hailo packages are not required to use the actual application. 
Any packages that have an * symbol are required to be installed for the actual application, while the rest are necessary for other code in the repository.


Tensorflow *

Ultralytics *

Numpy *

Tkinter *

Customtkinter *

Pillow (PIL) *

Datetime *

open-cv*

Matplotlib

Pandas

scikit-learn

Hailo Dataflow Compiler

HailoRT

PyTorch

Shutil

Itertools

Pathlkb

Seaborn

Math




# Section 5 - Raspberry Pi 5 (RPI 5)

This project involved running and testing my models on a Raspberry Pi 5 and Hailo 8L AI chip. There is some code included for the conversion and interaction with these models, as well as other parts including the RPI 5. 


<img width="743" alt="Screenshot 2024-12-27 at 5 45 25 PM" src="https://github.com/user-attachments/assets/e0f3ecb8-6205-47da-88f9-8feec1d91001" />



# Section 6 - Version history

All 4 completed versions of this application are included in this repository.

Version 1 - 

This was the initial application. It was able to process pre recorded videos using the main deep learning backend detailed in section 3. It processed a 1 minute video on an average of 2-5 minutes. The output of the models would then be very briefly displayed. The accuracy of this application was near 0%. 




<img width="1095" alt="Screenshot 2024-12-03 at 12 37 55 PM" src="https://github.com/user-attachments/assets/27f0ebcb-81a7-465f-b78a-4445caba034e" />

Version 2 -

This version was the most drastic update to the application. 
It included:

	
- Live analysis feature
	
- Live preview of model processing
	
- Instant results
	
- Dramatically faster processing
	
- Updated UI



 
-Adjustable confidence parameter for R-CNN
Version 3 - 
	
This version fixed extreme class bias by adding a model selection feature, running multiple CNN’s, each for a specific crop, to increase the accuracy to 95.37%.

Version 4 -
	
This version mainly updated the GUI, adding a disease info panel for treatment options and disease context. As well, it added a zoom feature to the settings tab to make viewing the crop feed much easier. 

<img width="1184" alt="Screenshot 2024-12-21 at 11 13 14 PM" src="https://github.com/user-attachments/assets/aaae9850-4705-4d1f-81f4-99f44b2f6d5a" />

------------------------iOS application beta images--------------


<img width="285" alt="Screenshot 2025-02-10 at 3 29 42 PM" src="https://github.com/user-attachments/assets/549b091a-2732-40bd-8b6a-a5d2f2180873" />



